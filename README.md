# ProseRender

ProseRender is a library for rendering JSON documents into HTML in Rails applications. It's designed for use with content generated by [ProseMirror](https://prosemirror.net) based JSON documents, following the ProseMirror schema. [TipTap](https://tiptap.dev), for example, follows the ProseMirror schema.

Rails has great tools already for handling rich text, such as Action Text and the accompanying Trix editor. However, most available tools available generate and save content as HTML. This tightly couples the content and markup, making changes to markup or content independently difficult.

ProseRender provides a default set of components, leveraging the [ViewComponent](https://viewcomponent.org) library. The default set should cover any default ProseMirror or TipTap generated elements. Additionally, you are able to override any existing components, or add new component types. 

## Installation

Start by including `prose_render` in your Gemfile:

```ruby
gem "prose_render"
```

Then run `bundle install`.

## Usage

Usage is straight forward to get started:

```ruby
# given a ProseMirror JSON document
prose_json = {
"type": "doc",
  "content": [
    { 
      "type": "paragraph", 
      "content": [
        { 
          "type": "text", 
          "text": "Hello, world!"
        }
      ]
    }
  ]
}

ProseRender::Document.render(prose_json)
```

## Custom Components

ProseRender supports registering your own components to use with the engine. This can be used to either override a current node/mark, or to extend based on any custom Prose Mirror node or mark you have.

First, create your custom component. You can inherit from the `ProseRender::Components::Base` class in order to easily render nested content. A custom `paragraph` node might look like this:

```ruby
# app/components/my_custom_paragraph.rb

class MyCustomParagraph < ProseRender::Components::Base
  def initialize(node:, **opts)
    @node = node
    @opts = opts
  end
  
  def call
    content_tag :p, class: 'my-paragraph-custom-class' do
      parse_prose_content(@node[:content])
    end
  end
end
```

Then, register the node type, and the component you want mapped to that type in the configure block in an initializer:

```ruby
# config/initializers/prose_render.rb

ProseRender.configure do |config|
  config.register_node('paragraph', "MyCustomParagraph")
end

```

When you restart your Rails server, any `paragraph` nodes will be rendered with your custom component. Marks can be done the same, using the `register_mark` method.

## TODO

- [ ] Support for all ProseMirror nodes and marks (including tables)
- [ ] Support TipTap nodes and marks
- [x] Entry point to define custom renderers
- [ ] Generators for blueprinting custom renders (e.g., for TipTap nodes)
- [ ] Support nesting passthrough via opts
- [ ] Some type of plugin system for CSS frameworks, like Bootstrap, Tailwind, Bulma?

## Contributing

Bug reports and pull requests are welcome on GitHub at https://github.com/mattbarrry/prose_render. This project is intended to be a safe, welcoming space for collaboration, and contributors are expected to adhere to the [code of conduct](https://github.com/[USERNAME]/prose_render/blob/master/CODE_OF_CONDUCT.md).

## License

The gem is available as open source under the terms of the [MIT License](https://opensource.org/licenses/MIT).

## Code of Conduct

Everyone interacting in the ProseRender project's codebases, issue trackers, chat rooms and mailing lists is expected to follow the [code of conduct](https://github.com/[USERNAME]/prose_render/blob/master/CODE_OF_CONDUCT.md).
